<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>MediLabo - Fiche Patient</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">

<div class="container mt-5">

    <div class="mb-4">
        <a href="/" class="btn btn-outline-secondary">&larr; Retour à la liste des patients</a>
    </div>

    <div class="row">
        <div class="col-lg-5">

            <div class="card shadow-sm mb-4">
                <div class="card-header bg-primary text-white">
                    <div class="d-flex justify-content-between align-items-center">
                        <h4 class="mb-0">Dossier Médical</h4>
                        <span class="badge bg-white text-primary" th:text="${'ID: ' + patient.id}">ID</span>
                    </div>
                </div>
                <div class="card-body">
                    <h2 class="text-primary fw-bold" th:text="${patient.nom + ' ' + patient.prenom}">NOM Prénom</h2>
                    <hr>
                    <div class="row">
                        <div class="col-6">
                            <p class="mb-1 text-muted">Genre</p>
                            <p class="fw-bold" th:text="${patient.genre}">M</p>
                        </div>
                        <div class="col-6">
                            <p class="mb-1 text-muted">Naissance</p>
                            <p class="fw-bold" th:text="${patient.dateDeNaissance}">01/01/1980</p>
                        </div>
                    </div>
                    <div class="mt-2">
                        <p class="mb-1 text-muted">Adresse</p>
                        <p class="fw-bold" th:text="${patient.adresse}">...</p>
                    </div>
                    <div>
                        <p class="mb-1 text-muted">Téléphone</p>
                        <p class="fw-bold" th:text="${patient.telephone}">...</p>
                    </div>
                    <div class="d-grid gap-2 mt-3">
                        <a th:href="@{/patient/update/{id}(id=${patient.id})}" class="btn btn-outline-primary btn-sm">Modifier les informations</a>
                    </div>
                </div>
            </div>

            <div class="card shadow-sm mb-4 border-danger">
                <div class="card-header bg-danger text-white">
                    <h5 class="mb-0"> Analyse du Risque</h5>
                </div>
                <div class="card-body text-center bg-white">
                    <p class="text-muted mb-1">Probabilité de diabète détectée :</p>
                    <h2 class="text-danger fw-bold text-uppercase" th:text="${risque}">EN ATTENTE</h2>
                </div>
            </div>

        </div>

        <div class="col-lg-7">
            <div class="card shadow-sm h-100">
                <div class="card-header bg-warning text-dark d-flex justify-content-between align-items-center">
                    <h4 class="mb-0">Notes du Praticien</h4>
                    <a th:href="@{/patient/{id}/note/add(id=${patient.id})}" class="btn btn-dark btn-sm shadow-sm">
                        + Nouvelle note
                    </a>
                </div>
                <div class="card-body bg-light">

                    <div th:if="${#lists.isEmpty(notes)}" class="alert alert-info text-center">
                        Aucune note n'a encore été enregistrée pour ce patient.
                    </div>

                    <div th:each="note : ${notes}" class="card mb-3 border-0 shadow-sm">
                        <div class="card-body position-relative">
                            <p class="card-text fs-5 text-dark" th:text="${note.note}">Contenu...</p>

                            <div class="text-end border-top pt-2 mt-2">
                                <small class="text-muted fst-italic">
                                    Enregistré le :
                                    <span th:if="${note.date != null}"
                                          th:text="${#temporals.format(note.date, 'dd/MM/yyyy à HH:mm')}">Date</span>
                                    <span th:if="${note.date == null}">Date inconnue</span>
                                </small>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

</body>
</html>